<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Админ-панель VexeraDubbing</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6a11cb;
            --secondary: #2575fc;
            --dark: #1a1a2e;
            --light: #f8f9fa;
            --accent: #ff6b6b;
            --success: #4caf50;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--dark), #16213e);
            color: var(--light);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
        }
        
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at top right, rgba(106, 17, 203, 0.1), transparent 70%);
            z-index: -1;
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header Styles */
        header {
            padding: 20px 0;
            position: sticky;
            top: 0;
            background: rgba(26, 26, 46, 0.95);
            backdrop-filter: blur(10px);
            z-index: 100;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }
        
        .logo-text {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        nav ul {
            display: flex;
            list-style: none;
            gap: 30px;
        }
        
        nav a {
            color: var(--light);
            text-decoration: none;
            font-weight: 500;
            font-size: 18px;
            transition: all 0.3s ease;
            padding: 5px 10px;
            border-radius: 5px;
        }
        
        nav a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--accent);
        }
        
        /* Admin Panel */
        .admin-panel {
            background: rgba(26, 26, 46, 0.9);
            border-radius: 20px;
            padding: 40px;
            margin-top: 60px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
        }
        
        .admin-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--dark), #16213e);
            z-index: -1;
        }
        
        .password-protection {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        
        .password-form {
            background: rgba(26, 26, 46, 0.95);
            padding: 40px;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(106, 17, 203, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        .password-form::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(106, 17, 203, 0.1), transparent 70%);
            z-index: -1;
        }
        
        .password-form h2 {
            font-size: 2rem;
            margin-bottom: 20px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .password-form p {
            margin-bottom: 25px;
            color: #cbd5e1;
            font-size: 1.1rem;
        }
        
        .password-input {
            position: relative;
            margin-bottom: 25px;
        }
        
        .password-input input {
            width: 100%;
            padding: 15px 50px 15px 20px;
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .password-input input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(106, 17, 203, 0.3);
        }
        
        .password-input i {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: #a5b4fc;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .password-input i:hover {
            color: var(--primary);
        }
        
        .password-strength {
            margin-top: 10px;
            height: 5px;
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.1);
            overflow: hidden;
        }
        
        .strength-meter {
            height: 100%;
            width: 0%;
            background: var(--accent);
            transition: width 0.3s ease;
        }
        
        .security-tip {
            font-size: 14px;
            color: #94a3b8;
            margin-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 15px;
        }
        
        .admin-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 20px;
        }
        
        .admin-status {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #4ade80;
            font-weight: 500;
        }
        
        .admin-status i {
            font-size: 20px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.7; }
        }
        
        .remove-social {
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            padding: 0 12px;
            transition: background 0.3s;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .remove-social:hover {
            background: #ff5252;
        }
        
        .social-field {
            margin-bottom: 10px;
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            display: none;
            color: white;
            text-align: center;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 5px solid var(--primary);
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .github-config {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            font-size: 14px;
        }
        
        .github-config p {
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .github-config p:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .config-label {
            color: #a5b4fc;
        }
        
        .config-value {
            font-weight: 500;
        }
        
        .success-message {
            background: rgba(76, 175, 80, 0.1);
            border: 1px solid rgba(76, 175, 80, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            display: none;
        }
        
        .error-message {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid rgba(255, 107, 107, 0.5);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
            text-align: center;
            display: none;
        }
        
        .token-input-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .token-input-section h4 {
            margin-bottom: 20px;
            color: #a5b4fc;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .token-input-section p {
            margin-bottom: 15px;
            color: #cbd5e1;
            font-size: 0.95rem;
        }
        
        .token-input {
            position: relative;
            margin-bottom: 20px;
        }
        
        .token-input input {
            width: 100%;
            padding: 15px 20px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.07);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 16px;
            font-family: monospace;
        }
        
        .token-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .btn-token {
            flex: 1;
            padding: 12px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-save-token {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
        }
        
        .btn-clear-token {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .btn-save-token:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(37, 117, 252, 0.4);
        }
        
        .btn-clear-token:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .token-hint {
            font-size: 13px;
            color: #94a3b8;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .token-hint a {
            color: #a5b4fc;
            text-decoration: none;
        }
        
        .token-hint a:hover {
            text-decoration: underline;
        }
        
        .password-hint {
            font-size: 12px;
            color: #94a3b8;
            margin-top: 5px;
            text-align: center;
        }
        
        .system-info {
            background: rgba(255, 255, 255, 0.03);
            padding: 15px;
            border-radius: 10px;
            margin-top: 30px;
            font-size: 13px;
            color: #94a3b8;
            text-align: center;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                gap: 20px;
            }
            
            nav ul {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .admin-panel {
                padding: 25px;
            }
            
            .password-form {
                padding: 30px 20px;
            }
            
            .token-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Password Protection Overlay -->
    <div class="password-protection" id="password-protection">
        <div class="password-form">
            <div class="logo" style="justify-content: center; margin-bottom: 20px;">
                <div class="logo-icon" style="margin: 0 auto 15px;">
                    <i class="fas fa-lock"></i>
                </div>
                <div class="logo-text" style="font-size: 2rem;">VexeraDubbing</div>
            </div>
            
            <h2>Административная панель</h2>
            <p>Введите пароль для доступа к системе управления</p>
            
            <form id="password-form">
                <div class="password-input">
                    <input type="password" id="password" placeholder="Введите пароль" autocomplete="off" required>
                    <i class="fas fa-eye" id="toggle-password"></i>
                </div>
                
                <div class="password-strength">
                    <div class="strength-meter" id="strength-meter"></div>
                </div>
                
                <button type="submit" class="btn btn-primary" style="width: 100%; padding: 15px; font-size: 1.1rem;">
                    <i class="fas fa-lock-open"></i> Получить доступ
                </button>
            </form>
            
            <div class="security-tip">
                <i class="fas fa-shield-alt"></i> Доступ разрешен только администраторам команды
            </div>
            <div class="password-hint">
                Подсказка: Пароль установлен создателем сайта
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="spinner"></div>
        <h3 id="loading-text">Подключаемся к GitHub...</h3>
        <p id="loading-details">Пожалуйста, подождите</p>
    </div>

    <!-- Header -->
    <header>
        <div class="container header-container">
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-microphone-alt"></i>
                </div>
                <div class="logo-text">VexeraDubbing</div>
            </div>
            <nav>
                <ul>
                    <li><a href="index.html"><i class="fas fa-home"></i> На главную</a></li>
                    <li><a href="index.html#dubbers"><i class="fas fa-users"></i> Дабберы</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Admin Panel -->
    <section class="section">
        <div class="container">
            <div class="section-title" style="text-align: center; margin-bottom: 30px;">
                <h2 style="font-size: 2.5rem; display: inline-block;
                    background: linear-gradient(45deg, var(--primary), var(--secondary));
                    -webkit-background-clip: text;
                    -webkit-text-fill-color: transparent;
                    position: relative;">
                    Админ-панель управления
                </h2>
            </div>
            
            <div class="admin-panel" id="admin-panel" style="display: none;">
                <div class="admin-controls">
                    <div class="admin-status">
                        <i class="fas fa-shield-alt"></i>
                        <span>Административный доступ</span>
                    </div>
                    <button class="btn btn-secondary" id="logout-btn">
                        <i class="fas fa-sign-out-alt"></i> Выйти из системы
                    </button>
                </div>
                
                <div class="success-message" id="success-message">
                    <i class="fas fa-check-circle" style="color: #4ade80; font-size: 2rem; margin-bottom: 10px;"></i>
                    <h3>Успешно!</h3>
                    <p id="success-text">Данные успешно сохранены в GitHub</p>
                </div>
                
                <div class="error-message" id="error-message">
                    <i class="fas fa-exclamation-triangle" style="color: #ff6b6b; font-size: 2rem; margin-bottom: 10px;"></i>
                    <h3>Ошибка!</h3>
                    <p id="error-text">Произошла ошибка при сохранении данных</p>
                </div>
                
                <!-- Раздел для ввода GitHub Token -->
                <div class="token-input-section">
                    <h4><i class="fab fa-github"></i> Настройка доступа к GitHub</h4>
                    
                    <p>Для работы с GitHub API необходимо ввести ваш Personal Access Token (PAT).</p>
                    
                    <div class="token-input">
                        <input type="password" id="github-token" placeholder="Введите ваш GitHub Personal Access Token" autocomplete="off">
                    </div>
                    
                    <div class="token-actions">
                        <button class="btn-token btn-save-token" id="save-token-btn">
                            <i class="fas fa-save"></i> Сохранить токен
                        </button>
                        <button class="btn-token btn-clear-token" id="clear-token-btn">
                            <i class="fas fa-trash"></i> Очистить токен
                        </button>
                    </div>
                    
                    <div class="token-hint">
                        <p><i class="fas fa-info-circle"></i> Вы можете создать токен в настройках GitHub:</p>
                        <p><a href="https://github.com/settings/tokens" target="_blank">https://github.com/settings/tokens</a></p>
                        <p>Убедитесь, что токен имеет права <code>repo</code> для работы с репозиторием.</p>
                    </div>
                </div>
                
                <div class="github-config">
                    <p>
                        <span class="config-label">Статус подключения:</span>
                        <span class="config-value" id="github-status">id="github-status">Ожидание токена...</span>
                    </p>
                    <p>
                        <span class="config-label">Репозиторий:</span>
                        <span class="config-value" id="github-repo">VexeraDubbing-Data</span>
                    </p>
                    <p>
                        <span class="config-label">Файл данных:</span>
                        <span class="config-value" id="github-file">dubbers.json</span>
                    </p>
                    <p>
                        <span class="config-label">Последнее обновление:</span>
                        <span class="config-value" id="github-updated">Неизвестно</span>
                    </p>
                </div>
                
                <h3>Добавить нового даббера</h3>
                
                <form id="dubber-form">
                    <div class="form-group">
                        <label for="dubber-name">Имя даббера</label>
                        <input type="text" id="dubber-name" class="form-control" placeholder="Введите полное имя" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="dubber-role">Роль/Специализация</label>
                        <input type="text" id="dubber-role" class="form-control" placeholder="Например: Актер дубляжа, звукорежиссер" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="dubber-bio">Описание</label>
                        <textarea id="dubber-bio" class="form-control" placeholder="Опыт работы, специализация, достижения" required rows="4"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="dubber-avatar">Ссылка на аватар (URL)</label>
                        <input type="url" id="dubber-avatar" class="form-control" placeholder="https://example.com/avatar.jpg" required>
                    </div>
                    
                    <div class="form-group">
                        <label>Социальные сети</label>
                        <div class="social-inputs">
                            <div class="social-field">
                                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                                    <input type="text" class="form-control social-name" placeholder="Соцсеть (VK, Telegram)" required>
                                    <input type="url" class="form-control social-url" placeholder="Ссылка" required>
                                    <button type="button" class="btn btn-danger remove-social"><i class="fas fa-trash"></i></button>
                                </div>
                            </div>
                            <button type="button" class="btn btn-secondary" id="add-social-btn">
                                <i class="fas fa-plus"></i> Добавить соцсеть
                            </button>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn btn-primary btn-block">
                        <i class="fab fa-github"></i> Сохранить через GitHub
                    </button>
                </form>
                
                <div class="system-info">
                    <i class="fas fa-info-circle"></i> Система автоматически сохраняет данные в репозиторий GitHub
                </div>
            </div>
            
            <div id="access-denied" style="display: none; text-align: center; padding: 50px;">
                <i class="fas fa-ban" style="font-size: 5rem; color: #ff6b6b; margin-bottom: 20px;"></i>
                <h3 style="font-size: 2rem; margin-bottom: 15px;">Доступ запрещен</h3>
                <p style="font-size: 1.2rem; margin-bottom: 30px;">У вас недостаточно прав для просмотра этой страницы</p>
                <a href="index.html" class="btn btn-primary">
                    <i class="fas fa-arrow-left"></i> Вернуться на главную
                </a>
            </div>
        </div>
    </section>

    <script>
        // Конфигурация GitHub API
        let GITHUB_TOKEN = localStorage.getItem('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') || "";
        const GITHUB_OWNER = "AkrifisOfficial"; // Замените на ваш логин GitHub
        const GITHUB_REPO = "Vexeradubdy"; // Репозиторий для данных
        const DATA_FILE = "data/dubbers.json"; // Файл с данными
        
        // Пароль для доступа
        const ADMIN_PASSWORD = "vexeradb24+1";
        
        // Элементы DOM
        const passwordProtection = document.getElementById('password-protection');
        const passwordForm = document.getElementById('password-form');
        const passwordInput = document.getElementById('password');
        const togglePassword = document.getElementById('toggle-password');
        const strengthMeter = document.getElementById('strength-meter');
        const adminPanel = document.getElementById('admin-panel');
        const accessDenied = document.getElementById('access-denied');
        const logoutBtn = document.getElementById('logout-btn');
        const loadingOverlay = document.getElementById('loading-overlay');
        const loadingText = document.getElementById('loading-text');
        const loadingDetails = document.getElementById('loading-details');
        const githubStatus = document.getElementById('github-status');
        const githubRepo = document.getElementById('github-repo');
        const githubFile = document.getElementById('github-file');
        const githubUpdated = document.getElementById('github-updated');
        const successMessage = document.getElementById('success-message');
        const successText = document.getElementById('success-text');
        const errorMessage = document.getElementById('error-message');
        const errorText = document.getElementById('error-text');
        const githubTokenInput = document.getElementById('github-token');
        const saveTokenBtn = document.getElementById('save-token-btn');
        const clearTokenBtn = document.getElementById('clear-token-btn');
        
        // Инициализация
        githubRepo.textContent = GITHUB_REPO;
        githubFile.textContent = DATA_FILE;
        githubTokenInput.value = GITHUB_TOKEN ? "••••••••••••••••••••••••••••••" : "";
        
        // Проверка авторизации при загрузке
        document.addEventListener('DOMContentLoaded', function() {
            const isAuthenticated = localStorage.getItem('isAuthenticated') === 'true';
            
            if (isAuthenticated) {
                showAdminPanel();
                if (GITHUB_TOKEN) {
                    checkGitHubConnection();
                } else {
                    githubStatus.textContent = "Введите GitHub Token";
                    githubStatus.style.color = "#ffca28";
                }
            } else {
                passwordProtection.style.display = 'flex';
            }
        });
        
        // Управление GitHub Token
        saveTokenBtn.addEventListener('click', function() {
            if (githubTokenInput.value && githubTokenInput.value !== "••••••••••••••••••••••••••••••") {
                GITHUB_TOKEN = githubTokenInput.value;
                localStorage.setItem('github_token', GITHUB_TOKEN);
                githubTokenInput.value = "••••••••••••••••••••••••••••••";
                showSuccess("GitHub Token успешно сохранен!");
                checkGitHubConnection();
            } else {
                showError("Введите действительный GitHub Token");
            }
        });
        
        clearTokenBtn.addEventListener('click', function() {
            GITHUB_TOKEN = "";
            localStorage.removeItem('github_token');
            githubTokenInput.value = "";
            githubStatus.textContent = "Токен удален";
            githubStatus.style.color = "#ff6b6b";
            showSuccess("GitHub Token был удален");
        });
        
        // Показать/скрыть пароль
        togglePassword.addEventListener('click', function() {
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                togglePassword.classList.replace('fa-eye', 'fa-eye-slash');
            } else {
                passwordInput.type = 'password';
                togglePassword.classList.replace('fa-eye-slash', 'fa-eye');
            }
        });
        
        // Индикатор сложности пароля
        passwordInput.addEventListener('input', function() {
            const password = passwordInput.value;
            let strength = 0;
            
            if (password.length > 0) strength += 25;
            if (password.length > 6) strength += 25;
            if (/[A-Z]/.test(password)) strength += 25;
            if (/[0-9]/.test(password)) strength += 25;
            
            strengthMeter.style.width = strength + '%';
            
            if (strength < 50) {
                strengthMeter.style.background = '#ff6b6b';
            } else if (strength < 75) {
                strengthMeter.style.background = '#ffca28';
            } else {
                strengthMeter.style.background = '#4ade80';
            }
        });
        
        // Проверка пароля
        passwordForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (passwordInput.value === ADMIN_PASSWORD) {
                // Успешная авторизация
                localStorage.setItem('isAuthenticated', 'true');
                showAdminPanel();
                passwordProtection.style.display = 'none';
                if (GITHUB_TOKEN) {
                    checkGitHubConnection();
                }
            } else {
                // Неверный пароль
                passwordInput.style.borderColor = '#ff6b6b';
                passwordInput.value = '';
                passwordInput.placeholder = 'Неверный пароль! Попробуйте еще раз';
                strengthMeter.style.width = '0%';
                
                // Анимация ошибки
                passwordInput.animate([
                    { transform: 'translateX(0)' },
                    { transform: 'translateX(-10px)' },
                    { transform: 'translateX(10px)' },
                    { transform: 'translateX(0)' }
                ], {
                    duration: 500,
                    iterations: 1
                });
            }
        });
        
        // Показать админ-панель
        function showAdminPanel() {
            adminPanel.style.display = 'block';
            initAdminPanel();
        }
        
        // Выход из системы
        logoutBtn.addEventListener('click', function() {
            localStorage.removeItem('isAuthenticated');
            window.location.reload();
        });
        
        // Проверка подключения к GitHub
        async function checkGitHubConnection() {
            if (!GITHUB_TOKEN) {
                githubStatus.textContent = "GitHub Token не установлен";
                githubStatus.style.color = "#ff6b6b";
                return;
            }
            
            showLoading(true, "Подключение к GitHub", "Проверяем доступ к репозиторию");
            githubStatus.textContent = "Проверка подключения...";
            githubStatus.style.color = "#ffca28";
            
            try {
                const response = await fetch(
                    `https://api.github.com/repos/${GITHUB_OWNER}/${GITHUB_REPO}/contents/${DATA_FILE}`,
                    {
                        headers: {
                            'Authorization': `Bearer ${GITHUB_TOKEN}`,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    }
                );
                
                if (response.ok) {
                    const data = await response.json();
                    githubStatus.textContent = "Подключено ✓";
                    githubStatus.style.color = "#4ade80";
                    
                    // Обновляем информацию о последнем обновлении
                    const updatedDate = new Date(data.commit.committer.date);
                    githubUpdated.textContent = updatedDate.toLocaleString();
                } else if (response.status === 404) {
                    githubStatus.textContent = "Репозиторий не найден";
                    githubStatus.style.color = "#ff6b6b";
                } else if (response.status === 403) {
                    githubStatus.textContent = "Доступ запрещен";
                    githubStatus.style.color = "#ff6b6b";
                } else {
                    githubStatus.textContent = "Ошибка подключения";
                    githubStatus.style.color = "#ff6b6b";
                }
            } catch (error) {
                githubStatus.textContent = "Ошибка сети";
                githubStatus.style.color = "#ff6b6b";
                console.error("GitHub connection error:", error);
            } finally {
                showLoading(false);
            }
        }
        
        // Показать/скрыть индикатор загрузки
        function showLoading(show, title = "", details = "") {
            if (show) {
                loadingOverlay.style.display = "flex";
                loadingText.textContent = title;
                loadingDetails.textContent = details;
            } else {
                loadingOverlay.style.display = "none";
            }
        }
        
        // Показать сообщение об успехе
        function showSuccess(message) {
            successText.textContent = message;
            successMessage.style.display = "block";
            errorMessage.style.display = "none";
            
            // Автоматически скрыть через 5 секунд
            setTimeout(() => {
                successMessage.style.display = "none";
            }, 5000);
        }
        
        // Показать сообщение об ошибке
        function showError(message) {
            errorText.textContent = message;
            errorMessage.style.display = "block";
            successMessage.style.display = "none";
        }
        
        // Инициализация админ-панели
        function initAdminPanel() {
            const dubberForm = document.getElementById('dubber-form');
            const socialContainer = document.querySelector('.social-inputs');
            
            // Добавление полей для соцсетей
            document.getElementById('add-social-btn').addEventListener('click', () => {
                const socialField = document.createElement('div');
                socialField.className = 'social-field';
                socialField.innerHTML = `
                    <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                        <input type="text" class="form-control social-name" placeholder="Соцсеть (VK, Telegram)" required>
                        <input type="url" class="form-control social-url" placeholder="Ссылка" required>
                        <button type="button" class="btn btn-danger remove-social"><i class="fas fa-trash"></i></button>
                    </div>
                `;
                socialContainer.insertBefore(socialField, document.getElementById('add-social-btn'));
                
                // Удаление поля
                socialField.querySelector('.remove-social').addEventListener('click', () => {
                    socialField.remove();
                });
            });
            
            // Удаление первого поля (если есть кнопка удаления)
            document.querySelectorAll('.remove-social').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.closest('.social-field').remove();
                });
            });
            
            // Отправка формы
            dubberForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                if (!GITHUB_TOKEN) {
                    showError("GitHub Token не установлен! Введите токен в разделе настройки доступа.");
                    return;
                }
                
                showLoading(true, "Сохранение данных", "Отправляем данные в GitHub");
                
                // Сбор данных формы
                const dubberData = {
                    name: document.getElementById('dubber-name').value,
                    role: document.getElementById('dubber-role').value,
                    bio: document.getElementById('dubber-bio').value,
                    avatar: document.getElementById('dubber-avatar').value,
                    socials: []
                };

                // Сбор социальных сетей
                document.querySelectorAll('.social-field').forEach(field => {
                    const name = field.querySelector('.social-name').value;
                    const url = field.querySelector('.social-url').value;
                    if (name && url) dubberData.socials.push({ name, url });
                });

                try {
                    // 1. Получаем текущие данные из GitHub
                    githubStatus.textContent = "Получение данных...";
                    githubStatus.style.color = "#ffca28";
                    
                    const fileResponse = await fetch(
                        `https://api.github.com/repos/${GITHUB_OWNER}/${GITHUB_REPO}/contents/${DATA_FILE}`,
                        {
                            headers: {
                                'Authorization': `Bearer ${GITHUB_TOKEN}`,
                                'Accept': 'application/vnd.github.v3+json'
                            }
                        }
                    );
                    
                    if (!fileResponse.ok) {
                        throw new Error('Ошибка получения данных: ' + fileResponse.status);
                    }
                    
                    const fileData = await fileResponse.json();
                    const currentContent = atob(fileData.content.replace(/\s/g, ''));
                    const dubbers = JSON.parse(currentContent);
                    
                    // 2. Добавляем нового даббера
                    dubbers.push(dubberData);
                    const newContent = JSON.stringify(dubbers, null, 2);
                    
                    // 3. Обновляем файл на GitHub
                    githubStatus.textContent = "Сохранение данных...";
                    githubStatus.style.color = "#ffca28";
                    
                    const updateResponse = await fetch(
                        `https://api.github.com/repos/${GITHUB_OWNER}/${GITHUB_REPO}/contents/${DATA_FILE}`,
                        {
                            method: 'PUT',
                            headers: {
                                'Authorization': `Bearer ${GITHUB_TOKEN}`,
                                'Accept': 'application/vnd.github.v3+json',
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                message: `Добавлен новый даббер: ${dubberData.name}`,
                                content: btoa(unescape(encodeURIComponent(newContent))),
                                sha: fileData.sha
                            })
                        }
                    );
                    
                    if (!updateResponse.ok) {
                        const errorData = await updateResponse.json();
                        throw new Error(errorData.message || 'Ошибка обновления файла');
                    }
                    
                    // Успешное сохранение
                    showSuccess(`Даббер "${dubberData.name}" успешно добавлен! Данные сохранены в GitHub.`);
                    githubStatus.textContent = "#4ade80";
                    
                    // Обновляем информацию о последнем обновлении
                    const updatedDate = new Date();
                    githubUpdated.textContent = updatedDate.toLocaleString();
                    
                    // Очистка формы
                    dubberForm.reset();
                    
                    // Очистка социальных сетей
                    const socialFields = document.querySelectorAll('.social-field');
                    socialFields.forEach((field, index) => {
                        if (index > 0) field.remove();
                        else {
                            // Сбрасываем первое поле
                            field.querySelector('.social-name').value = '';
                            field.querySelector('.social-url').value = '';
                        }
                    });
                    
                } catch (error) {
                    console.error('Ошибка:', error);
                    showError('Ошибка при сохранении данных: ' + error.message);
                    githubStatus.textContent = "Ошибка: " + error.message;
                    githubStatus.style.color = "#ff6b6b";
                } finally {
                    showLoading(false);
                }
            });
        }
    </script>
</body>
</html>